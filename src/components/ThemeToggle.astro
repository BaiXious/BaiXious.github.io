---
---

<button 
  id="theme-toggle" 
  class="p-2 rounded-lg text-[var(--color-muted)] hover:text-[var(--color-fg)] hover:bg-[var(--color-card)] transition-colors"
  aria-label="切换主题"
>
  <!-- Sun icon -->
  <svg id="icon-sun" class="w-5 h-5 hidden" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
    <circle cx="12" cy="12" r="5"/>
    <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
  </svg>
  
  <!-- Moon icon -->
  <svg id="icon-moon" class="w-5 h-5 hidden" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
  </svg>
  
  <!-- Blue icon (palette) -->
  <svg id="icon-blue" class="w-5 h-5 hidden" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
    <circle cx="12" cy="12" r="10"/>
    <circle cx="12" cy="12" r="4" fill="currentColor"/>
    <path d="M12 2v4M12 18v4M2 12h4M18 12h4"/>
  </svg>
</button>

<script>
  const button = document.getElementById('theme-toggle');
  const iconSun = document.getElementById('icon-sun');
  const iconMoon = document.getElementById('icon-moon');
  const iconBlue = document.getElementById('icon-blue');
  
  function updateIcon(theme) {
    iconSun.classList.add('hidden');
    iconMoon.classList.add('hidden');
    iconBlue.classList.add('hidden');
    
    if (theme === 'light') {
      iconSun.classList.remove('hidden');
    } else if (theme === 'dark') {
      iconMoon.classList.remove('hidden');
    } else if (theme === 'blue') {
      iconBlue.classList.remove('hidden');
    }
  }
  
  function getCurrentTheme() {
    const root = document.documentElement;
    if (root.classList.contains('blue')) return 'blue';
    if (root.classList.contains('dark')) return 'dark';
    return 'light';
  }
  
  function toggleTheme() {
    const current = getCurrentTheme();
    const themes = ['light', 'dark', 'blue'];
    const nextIndex = (themes.indexOf(current) + 1) % themes.length;
    const nextTheme = themes[nextIndex];
    
    const root = document.documentElement;
    root.classList.remove('dark', 'blue');
    
    if (nextTheme === 'dark') {
      root.classList.add('dark');
    } else if (nextTheme === 'blue') {
      root.classList.add('blue');
    }
    
    localStorage.setItem('blog-theme', nextTheme);
    updateIcon(nextTheme);
  }
  
  // Initialize
  const storedTheme = localStorage.getItem('blog-theme') || 'light';
  updateIcon(storedTheme);
  
  button.addEventListener('click', toggleTheme);
</script>
